<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ACAG Search</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
}

:root{
    --bg-primary:#0d0f16;
    --bg-secondary:#161923;
    --bg-card:#1c1f2e;
    --bg-elevated:#242938;
    --accent-primary:#00e5ff;
    --accent-secondary:#a855f7;
    --accent-tertiary:#06b6d4;
    --text-primary:#ffffff;
    --text-secondary:#9ca3af;
    --text-muted:#6b7280;
    --success:#22c55e;
    --warning:#f59e0b;
    --error:#ef4444;
    --border:#2d3340;
    --border-light:#374151;
    --glow-primary:rgba(0,229,255,0.4);
    --glow-secondary:rgba(168,85,247,0.4);
}

body{
    background:var(--bg-primary);
    color:var(--text-primary);
    font-family:'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    min-height:100vh;
    position:relative;
    overflow-x:hidden;
    line-height:1.6;
}

/* Animated Gradient Background */
body::before{
    content:'';
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:
        radial-gradient(circle at 15% 20%, rgba(0,229,255,0.06) 0%, transparent 60%),
        radial-gradient(circle at 85% 80%, rgba(168,85,247,0.06) 0%, transparent 60%),
        radial-gradient(circle at 50% 50%, rgba(6,182,212,0.03) 0%, transparent 70%);
    z-index:0;
    animation:gradientShift 25s ease-in-out infinite;
}

@keyframes gradientShift{
    0%, 100%{opacity:1; transform:scale(1);}
    50%{opacity:0.8; transform:scale(1.05);}
}

/* Grid Pattern Overlay */
body::after{
    content:'';
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background-image:
        linear-gradient(var(--border) 1px, transparent 1px),
        linear-gradient(90deg, var(--border) 1px, transparent 1px);
    background-size:50px 50px;
    opacity:0.03;
    z-index:0;
    pointer-events:none;
}

.container{
    max-width:1400px;
    margin:0 auto;
    padding:40px 24px;
    position:relative;
    z-index:1;
}

/* Header Section with Glass Effect */
.header{
    text-align:center;
    margin-bottom:48px;
    animation:fadeInDown 0.6s cubic-bezier(0.16, 1, 0.3, 1);
}

@keyframes fadeInDown{
    from{opacity:0; transform:translateY(-40px);}
    to{opacity:1; transform:translateY(0);}
}

.logo-container{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    width:80px;
    height:80px;
    background:linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    border-radius:24px;
    margin-bottom:24px;
    box-shadow:
        0 0 40px var(--glow-primary),
        0 10px 30px rgba(0,0,0,0.3);
    animation:logoFloat 3s ease-in-out infinite;
    position:relative;
}

@keyframes logoFloat{
    0%, 100%{transform:translateY(0) rotate(0deg);}
    50%{transform:translateY(-8px) rotate(2deg);}
}

.logo-container::before{
    content:'';
    position:absolute;
    inset:-2px;
    background:linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    border-radius:24px;
    filter:blur(15px);
    opacity:0.5;
    z-index:-1;
    animation:pulse 2s ease-in-out infinite;
}

@keyframes pulse{
    0%, 100%{opacity:0.5; transform:scale(1);}
    50%{opacity:0.8; transform:scale(1.1);}
}

.logo-container svg{
    width:40px;
    height:40px;
    filter:drop-shadow(0 2px 8px rgba(0,0,0,0.3));
}

.header h1{
    font-size:3.5rem;
    font-weight:800;
    background:linear-gradient(135deg, var(--accent-primary), var(--accent-tertiary), var(--accent-secondary));
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    background-clip:text;
    margin-bottom:12px;
    letter-spacing:-2px;
    line-height:1.1;
}

.header p{
    color:var(--text-secondary);
    font-size:1.125rem;
    font-weight:400;
    max-width:600px;
    margin:0 auto;
}

/* Glass Card Style */
.glass-card{
    background:rgba(28, 31, 46, 0.6);
    backdrop-filter:blur(20px) saturate(180%);
    border:1px solid var(--border);
    border-radius:24px;
    box-shadow:
        0 20px 60px rgba(0,0,0,0.4),
        inset 0 1px 0 rgba(255,255,255,0.05);
    position:relative;
    overflow:hidden;
}

.glass-card::before{
    content:'';
    position:absolute;
    top:0;
    left:0;
    right:0;
    height:1px;
    background:linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
}

/* Data Status Card */
.data-status{
    padding:24px 32px;
    margin-bottom:32px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:20px;
    animation:fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) 0.1s both;
}

@keyframes fadeInUp{
    from{opacity:0; transform:translateY(40px);}
    to{opacity:1; transform:translateY(0);}
}

.data-info{
    display:flex;
    align-items:center;
    gap:20px;
    flex:1;
}

.data-icon{
    width:56px;
    height:56px;
    background:linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    border-radius:16px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:28px;
    box-shadow:0 8px 24px var(--glow-primary);
    animation:iconBounce 2s ease-in-out infinite;
    position:relative;
}

@keyframes iconBounce{
    0%, 100%{transform:translateY(0) scale(1);}
    50%{transform:translateY(-4px) scale(1.05);}
}

.data-details h3{
    font-size:1.125rem;
    font-weight:600;
    margin-bottom:4px;
    color:var(--text-primary);
}

.data-details p{
    color:var(--text-muted);
    font-size:0.875rem;
    font-family:'JetBrains Mono', monospace;
    font-weight:500;
}

.data-badge{
    padding:10px 20px;
    background:rgba(34,197,94,0.12);
    color:var(--success);
    border-radius:100px;
    font-size:0.875rem;
    font-weight:600;
    display:flex;
    align-items:center;
    gap:8px;
    border:1px solid rgba(34,197,94,0.2);
    white-space:nowrap;
}

.data-badge.loading{
    background:rgba(0,229,255,0.12);
    color:var(--accent-primary);
    border-color:rgba(0,229,255,0.2);
}

.spinner{
    width:16px;
    height:16px;
    border:2px solid transparent;
    border-top-color:currentColor;
    border-radius:50%;
    animation:spin 0.6s linear infinite;
}

@keyframes spin{
    to{transform:rotate(360deg);}
}

/* Search Card */
.search-card{
    padding:40px;
    margin-bottom:40px;
    animation:fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) 0.2s both;
}

.search-tabs{
    display:flex;
    gap:8px;
    margin-bottom:32px;
    padding:6px;
    background:var(--bg-secondary);
    border-radius:16px;
    border:1px solid var(--border);
}

.tab-btn{
    flex:1;
    padding:12px 24px;
    background:transparent;
    border:none;
    border-radius:12px;
    color:var(--text-secondary);
    font-size:0.9375rem;
    font-weight:600;
    cursor:pointer;
    transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position:relative;
    font-family:inherit;
}

.tab-btn:hover{
    color:var(--text-primary);
    background:rgba(255,255,255,0.03);
}

.tab-btn.active{
    background:linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    color:var(--text-primary);
    box-shadow:0 4px 16px var(--glow-primary);
}

.search-form{
    display:flex;
    gap:16px;
    align-items:stretch;
}

.input-wrapper{
    flex:1;
    position:relative;
}

.input-label{
    display:block;
    font-size:0.875rem;
    font-weight:600;
    color:var(--text-secondary);
    margin-bottom:8px;
    text-transform:uppercase;
    letter-spacing:0.5px;
}

.input-wrapper input{
    width:100%;
    padding:18px 24px;
    font-size:1.125rem;
    font-family:'JetBrains Mono', monospace;
    font-weight:500;
    background:var(--bg-secondary);
    border:2px solid var(--border);
    border-radius:16px;
    color:var(--text-primary);
    transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.input-wrapper input:focus{
    outline:none;
    border-color:var(--accent-primary);
    background:var(--bg-elevated);
    box-shadow:
        0 0 0 4px rgba(0,229,255,0.1),
        0 8px 24px rgba(0,0,0,0.2);
    transform:translateY(-2px);
}

.input-wrapper input::placeholder{
    color:var(--text-muted);
    font-weight:400;
}

.search-btn{
    padding:18px 48px;
    font-size:1.125rem;
    font-weight:700;
    background:linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    border:none;
    border-radius:16px;
    color:var(--text-primary);
    cursor:pointer;
    transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position:relative;
    overflow:hidden;
    font-family:inherit;
    box-shadow:
        0 0 30px var(--glow-primary),
        0 8px 24px rgba(0,0,0,0.3);
}

.search-btn::before{
    content:'';
    position:absolute;
    top:0;
    left:-100%;
    width:100%;
    height:100%;
    background:linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition:left 0.5s;
}

.search-btn:hover{
    transform:translateY(-3px);
    box-shadow:
        0 0 40px var(--glow-primary),
        0 12px 32px rgba(0,0,0,0.4);
}

.search-btn:hover::before{
    left:100%;
}

.search-btn:active{
    transform:translateY(-1px);
}

.search-btn.searching{
    pointer-events:none;
    opacity:0.8;
}

/* Results Section */
.results-section{
    animation:fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) 0.3s both;
}

.results-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:24px;
    flex-wrap:wrap;
    gap:16px;
}

.results-header h2{
    font-size:2rem;
    font-weight:700;
    background:linear-gradient(135deg, var(--text-primary), var(--text-secondary));
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    background-clip:text;
}

.results-count{
    padding:10px 20px;
    background:var(--bg-card);
    border:1px solid var(--border);
    border-radius:100px;
    font-size:0.9375rem;
    font-weight:600;
    color:var(--text-secondary);
}

/* Table Container */
.table-container{
    position:relative;
    overflow-x:auto;
    border-radius:24px;
}

.table-wrapper{
    overflow-x:auto;
}

table{
    width:100%;
    border-collapse:separate;
    border-spacing:0;
}

thead{
    background:var(--bg-secondary);
    position:sticky;
    top:0;
    z-index:10;
}

th{
    padding:20px 24px;
    text-align:left;
    font-weight:700;
    font-size:0.875rem;
    color:var(--accent-primary);
    text-transform:uppercase;
    letter-spacing:1px;
    border-bottom:2px solid var(--border);
    white-space:nowrap;
}

tbody tr{
    border-bottom:1px solid var(--border);
    transition:all 0.2s ease;
    animation:slideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1) backwards;
}

@keyframes slideIn{
    from{
        opacity:0;
        transform:translateX(-20px);
    }
    to{
        opacity:1;
        transform:translateX(0);
    }
}

tbody tr:hover{
    background:rgba(0,229,255,0.04);
    transform:translateX(4px);
}

tbody tr:last-child{
    border-bottom:none;
}

td{
    padding:20px 24px;
    color:var(--text-primary);
    font-size:0.9375rem;
    font-weight:500;
}

td:first-child{
    font-family:'JetBrains Mono', monospace;
    color:var(--accent-tertiary);
    font-weight:600;
}

/* State Styles */
.empty-state,
.loading-state,
.error-state{
    padding:80px 40px;
    text-align:center;
}

.empty-icon,
.loading-icon,
.error-icon{
    width:80px;
    height:80px;
    margin:0 auto 24px;
    background:linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    border-radius:50%;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:36px;
    box-shadow:0 0 40px var(--glow-primary);
}

.loading-spinner{
    width:60px;
    height:60px;
    margin:0 auto 24px;
    border:4px solid var(--border);
    border-top-color:var(--accent-primary);
    border-radius:50%;
    animation:spin 0.8s linear infinite;
}

.error-icon{
    background:rgba(239,68,68,0.15);
    color:var(--error);
    box-shadow:0 0 40px rgba(239,68,68,0.3);
}

.empty-state h3,
.loading-state h3,
.error-state h3{
    font-size:1.5rem;
    font-weight:700;
    margin-bottom:8px;
}

.empty-state p,
.loading-state p,
.error-state p{
    color:var(--text-secondary);
    font-size:1rem;
}

/* Responsive Design */
@media(max-width:768px){
    .header h1{
        font-size:2.5rem;
    }
    
    .data-status{
        flex-direction:column;
        text-align:center;
    }
    
    .search-form{
        flex-direction:column;
    }
    
    .search-card{
        padding:28px;
    }
    
    .search-tabs{
        flex-direction:column;
    }
    
    .results-header{
        flex-direction:column;
        align-items:flex-start;
    }
    
    table{
        font-size:0.875rem;
    }
    
    th, td{
        padding:16px;
    }
    
    .search-btn{
        width:100%;
    }
}

/* Smooth Scrollbar */
::-webkit-scrollbar{
    width:10px;
    height:10px;
}

::-webkit-scrollbar-track{
    background:var(--bg-secondary);
}

::-webkit-scrollbar-thumb{
    background:var(--border-light);
    border-radius:5px;
}

::-webkit-scrollbar-thumb:hover{
    background:var(--accent-primary);
}

/* Accessibility */
@media(prefers-reduced-motion:reduce){
    *{
        animation:none !important;
        transition:none !important;
    }
}
</style>
</head>

<body>
<div class="container">

<!-- Header -->
<div class="header">
    <div class="logo-container">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21 21L15 15M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </div>
    <h1>ACAG Search 2026</h1>
    <p>Advanced Multi-Column Search System with Real-time Data</p>
</div>

<!-- Data Status Card -->
<div class="glass-card data-status" id="dataStatus">
    <div class="data-info">
        <div class="data-icon">üìä</div>
        <div class="data-details">
            <h3>Data Connection</h3>
            <p id="sheetInfo">Initializing connection...</p>
        </div>
    </div>
    <div class="data-badge loading" id="statusBadge">
        <span class="spinner"></span>
        <span>Loading...</span>
    </div>
</div>

<!-- Search Card -->
<div class="glass-card search-card">
    <div class="search-tabs">
        <button class="tab-btn active" onclick="switchTab('cnic')">CNIC Search</button>
        <button class="tab-btn" onclick="switchTab('name')">Name Search</button>
        <button class="tab-btn" onclick="switchTab('contact')">Contact Search</button>
        <button class="tab-btn" onclick="switchTab('branch')">Branch Search</button>
        <button class="tab-btn" onclick="switchTab('batch')">Batch Search</button>
    </div>
    
    <div class="search-form">
        <div class="input-wrapper">
            <label class="input-label" id="inputLabel">Search by CNIC</label>
            <input 
                type="text" 
                id="searchInput" 
                placeholder="Enter CNIC (XXXXX-XXXXXXX-X)" 
                autocomplete="off"
            >
        </div>
        <button class="search-btn" id="searchBtn" onclick="searchData()">
            <span id="btnText">üîç Search</span>
        </button>
    </div>
</div>

<!-- Results Section -->
<div class="results-section">
    <div class="results-header">
        <h2>Search Results</h2>
        <div class="results-count" id="resultsCount">
            Ready to search
        </div>
    </div>
    
    <div class="glass-card table-container">
        <div class="table-wrapper">
            <table>
                <tbody id="resultTable">
                    <tr>
                        <td colspan="7" class="empty-state">
                            <div class="empty-icon">üîç</div>
                            <h3>Ready to Search</h3>
                            <p>Select a search type and enter your query above</p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

</div>

<script>
// ================== GOOGLE SHEET CONFIG ==================
const SHEET_ID = "1WxFeeRY5X8KaMAmZjogReKFHZaWi8We3";
const SHEET_NAME = "Sheet1";

// ================== GLOBAL DATA ==================
let excelData = [];
let dataLoaded = false;
let currentTab = 'cnic';

// ================== LOAD DATA ON PAGE LOAD ==================
window.onload = async function(){
    await loadData();
    document.getElementById("searchInput").focus();
};

// ================== LOAD DATA FROM GOOGLE SHEETS ==================
async function loadData(){
    const statusBadge = document.getElementById("statusBadge");
    const sheetInfo = document.getElementById("sheetInfo");
    
    try{
        statusBadge.className = "data-badge loading";
        statusBadge.innerHTML = '<span class="spinner"></span><span>Connecting...</span>';
        sheetInfo.textContent = "Establishing connection to Google Sheets...";
        
        // Using Google Sheets CSV export with optimized fetch
        const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${SHEET_NAME}`;
        
        const startTime = performance.now();
        
        // Fetch with optimized settings
        const res = await fetch(url, {
            method: 'GET',
            cache: 'default',
            mode: 'cors'
        });
        
        if (!res.ok) {
            throw new Error(`HTTP error! status: ${res.status}`);
        }
        
        const text = await res.text();
        const loadTime = Math.round(performance.now() - startTime);
        
        // Parse CSV data
        excelData = parseCSV(text);
        dataLoaded = true;
        
        // Update UI with success
        const recordCount = excelData.length - 1; // Exclude header
        statusBadge.className = "data-badge";
        statusBadge.innerHTML = '<span>‚úì</span><span>Connected</span>';
        sheetInfo.innerHTML = `Sheet: <strong>${SHEET_NAME}</strong> ‚Ä¢ Records: <strong>${recordCount.toLocaleString()}</strong> ‚Ä¢ Load: <strong>${loadTime}ms</strong>`;
        
        console.log(`‚úì Data loaded: ${recordCount} records in ${loadTime}ms`);
        
    }catch(error){
        console.error("Data load error:", error);
        statusBadge.className = "data-badge";
        statusBadge.style.background = "rgba(239,68,68,0.12)";
        statusBadge.style.borderColor = "rgba(239,68,68,0.2)";
        statusBadge.style.color = "var(--error)";
        statusBadge.innerHTML = '<span>‚ö†</span><span>Connection Failed</span>';
        sheetInfo.textContent = "Failed to load data. Please check the sheet link and refresh.";
    }
}

// ================== OPTIMIZED CSV PARSER ==================
function parseCSV(csv){
    const lines = csv.split("\n").filter(line => line.trim());
    return lines.map(line => {
        const cells = [];
        let cell = '';
        let inQuotes = false;
        
        for(let i = 0; i < line.length; i++){
            const char = line[i];
            const nextChar = line[i + 1];
            
            if(char === '"'){
                if(inQuotes && nextChar === '"'){
                    cell += '"';
                    i++;
                }else{
                    inQuotes = !inQuotes;
                }
            }else if(char === ',' && !inQuotes){
                cells.push(cell.trim());
                cell = '';
            }else{
                cell += char;
            }
        }
        cells.push(cell.trim());
        return cells;
    });
}

// ================== TAB SWITCHING ==================
function switchTab(tab){
    currentTab = tab;
    
    // Update tab buttons
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // Update input placeholder and label
    const input = document.getElementById("searchInput");
    const label = document.getElementById("inputLabel");
    
    const config = {
        'cnic': {
            label: 'Search by CNIC',
            placeholder: 'Enter CNIC (XXXXX-XXXXXXX-X)',
            maxlength: 15
        },
        'name': {
            label: 'Search by Name',
            placeholder: 'Enter Applicant Name',
            maxlength: 100
        },
        'contact': {
            label: 'Search by Contact',
            placeholder: 'Enter Contact Number',
            maxlength: 15
        },
        'branch': {
            label: 'Search by Branch',
            placeholder: 'Enter Branch Name or Code',
            maxlength: 100
        },
        'batch': {
            label: 'Search by Batch',
            placeholder: 'Enter Batch Number',
            maxlength: 50
        }
    };
    
    label.textContent = config[tab].label;
    input.placeholder = config[tab].placeholder;
    input.maxLength = config[tab].maxlength;
    input.value = '';
    input.focus();
    
    // Clear results
    showEmptyState();
}

// ================== NORMALIZE FUNCTION ==================
function normalize(val){
    return String(val || "").toLowerCase().trim();
}

function normalizeCNIC(val){
    return String(val || "").replace(/\D/g, "");
}

// ================== SEARCH FUNCTION ==================
function searchData(){
    if(!dataLoaded){
        showError("Data not loaded yet. Please wait...");
        return;
    }
    
    const input = document.getElementById("searchInput").value.trim();
    const searchBtn = document.getElementById("searchBtn");
    const btnText = document.getElementById("btnText");
    const resultsCount = document.getElementById("resultsCount");
    
    if(!input){
        showError("Please enter a search query");
        return;
    }
    
    // Show loading state
    searchBtn.classList.add("searching");
    btnText.textContent = "‚è≥ Searching...";
    showLoading();
    
    // Perform search with slight delay for better UX
    setTimeout(() => {
        const startTime = performance.now();
        let results = [];
        
        const rows = excelData.slice(1); // Skip header
        
        // Search based on current tab
        switch(currentTab){
            case 'cnic':
                const cnicQuery = normalizeCNIC(input);
                if(cnicQuery.length !== 13){
                    searchBtn.classList.remove("searching");
                    btnText.textContent = "üîç Search";
                    showError("Please enter a valid 13-digit CNIC");
                    return;
                }
                results = rows.filter(r => normalizeCNIC(r[1]) === cnicQuery);
                break;
                
            case 'name':
                const nameQuery = normalize(input);
                results = rows.filter(r => normalize(r[2]).includes(nameQuery));
                break;
                
            case 'contact':
                const contactQuery = normalizeCNIC(input);
                results = rows.filter(r => normalizeCNIC(r[3]).includes(contactQuery));
                break;
                
            case 'branch':
                const branchQuery = normalize(input);
                results = rows.filter(r => 
                    normalize(r[4]).includes(branchQuery) || 
                    normalize(r[5]).includes(branchQuery)
                );
                break;
                
            case 'batch':
                const batchQuery = normalize(input);
                results = rows.filter(r => normalize(r[6]).includes(batchQuery));
                break;
        }
        
        const searchTime = Math.round(performance.now() - startTime);
        
        searchBtn.classList.remove("searching");
        btnText.textContent = "üîç Search";
        
        if(results.length === 0){
            showNoResults();
            resultsCount.textContent = "No results found";
        }else{
            displayResults(results);
            resultsCount.textContent = `Found ${results.length} record${results.length > 1 ? 's' : ''} (${searchTime}ms)`;
        }
        
        console.log(`Search completed: ${results.length} results in ${searchTime}ms`);
    }, 400);
}

// ================== SHOW LOADING STATE ==================
function showLoading(){
    const table = document.getElementById("resultTable");
    table.innerHTML = `
        <tr>
            <td colspan="7" class="loading-state">
                <div class="loading-spinner"></div>
                <h3>Processing Search...</h3>
                <p>Searching through database records</p>
            </td>
        </tr>`;
}

// ================== SHOW EMPTY STATE ==================
function showEmptyState(){
    const table = document.getElementById("resultTable");
    const resultsCount = document.getElementById("resultsCount");
    table.innerHTML = `
        <tr>
            <td colspan="7" class="empty-state">
                <div class="empty-icon">üîç</div>
                <h3>Ready to Search</h3>
                <p>Select a search type and enter your query above</p>
            </td>
        </tr>`;
    resultsCount.textContent = "Ready to search";
}

// ================== SHOW NO RESULTS ==================
function showNoResults(){
    const table = document.getElementById("resultTable");
    table.innerHTML = `
        <tr>
            <td colspan="7" class="error-state">
                <div class="error-icon">‚ùå</div>
                <h3>No Records Found</h3>
                <p>No matching records found in the database</p>
            </td>
        </tr>`;
}

// ================== SHOW ERROR ==================
function showError(message){
    const table = document.getElementById("resultTable");
    const resultsCount = document.getElementById("resultsCount");
    table.innerHTML = `
        <tr>
            <td colspan="7" class="error-state">
                <div class="error-icon">‚ö†Ô∏è</div>
                <h3>Error</h3>
                <p>${message}</p>
            </td>
        </tr>`;
    resultsCount.textContent = "Error";
}

// ================== DISPLAY RESULTS ==================
function displayResults(results){
    const table = document.getElementById("resultTable");
    
    let html = `
    <tr>
        <th>Sr No.</th>
        <th>CNIC</th>
        <th>Applicant Name</th>
        <th>Contact No.</th>
        <th>Branch Name</th>
        <th>Branch Code</th>
        <th>Batch No.</th>
    </tr>`;
    
    results.forEach((r, index) => {
        html += `
        <tr style="animation-delay:${0.05 + (index * 0.03)}s">
            <td>${r[0] || "-"}</td>
            <td>${r[1] || "-"}</td>
            <td>${r[2] || "-"}</td>
            <td>${r[3] || "-"}</td>
            <td>${r[4] || "-"}</td>
            <td>${r[5] || "-"}</td>
            <td>${r[6] || "-"}</td>
        </tr>`;
    });
    
    table.innerHTML = html;
}

// ================== AUTO-FORMATTING FOR CNIC TAB ==================
document.getElementById("searchInput").addEventListener("input", e => {
    if(currentTab === 'cnic'){
        let v = e.target.value.replace(/\D/g, "").slice(0, 13);
        if(v.length > 5) v = v.slice(0, 5) + "-" + v.slice(5);
        if(v.length > 13) v = v.slice(0, 13) + "-" + v.slice(13);
        e.target.value = v;
    }
});

// ================== KEYBOARD SUPPORT ==================
document.getElementById("searchInput").addEventListener("keypress", e => {
    if(e.key === "Enter"){
        e.preventDefault();
        searchData();
    }
});

document.getElementById("searchInput").addEventListener("keydown", e => {
    if(e.key === "Escape"){
        e.target.value = "";
        e.target.focus();
        showEmptyState();
    }
});
</script>

</body>
</html>
